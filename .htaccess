RewriteEngine On

# deny access to files that may contain sensitive information
RewriteRule ^(.*/)?\.(editor|git|ht|jshint|travis) - [L,F]
RewriteRule ^(codeception(.*)\.yml|composer(.*)\.(json|lock)|package\.json)$ - [L,F]
RewriteRule ^files/(attach|config|cache/store)/.+\.php$ - [L,F]
RewriteRule ^files/(env|member_extra_info/(new_message_flags|point))/ - [L,F]

# reserve XE Layout Template Source File (*.html)
RewriteRule ^(layouts|m.layouts|files/faceOff)/(.+)\.html$ - [L,F]
# reserve XE Template Source Files (*.html)
RewriteCond %{REQUEST_URI} !/modules/editor/
RewriteRule /(skins|m.skins)/(.+)\.html$ - [L,F]

# conf, query, schema
RewriteRule ^(modules|addons|widgets)/(.+)/(conf|queries|schemas)/(.+)\.xml$ ./index.php [L]

# static files
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule ^(.+)/files/(member_extra_info|attach|cache|faceOff)/(.*) ./files/$2/$3 [L]
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule ^(.+)/(files|modules|widgets|widgetstyles|layouts|m.layouts|addons)/(.*) ./$2/$3 [L]

# rss , blogAPI
RewriteRule ^(rss|atom)$ ./index.php?module=rss&act=$1 [L]
RewriteRule ^([a-zA-Z0-9_]+)/(rss|atom|api)$ ./index.php?mid=$1&act=$2 [L]
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/(rss|atom|api)$ ./index.php?vid=$1&mid=$2&act=$3 [L]

# trackback
RewriteRule ^([0-9]+)/(.+)/trackback$ ./index.php?document_srl=$1&key=$2&act=trackback [L]
RewriteRule ^([a-zA-Z0-9_]+)/([0-9]+)/(.+)/trackback$ ./index.php?mid=$1&document_srl=$2&key=$3&act=trackback [L]
RewriteRule ^([a-zA-Z0-9_]+)/([0-9]+)/(.+)/trackback$ ./index.php?vid=$1&document_srl=$2&key=$3&act=trackback [L]
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/([0-9]+)/(.+)/trackback$ ./index.php?vid=$1&mid=$2&document_srl=$3&key=$4&act=trackback [L]

# document permanent link
RewriteRule ^([0-9]+)$ ./index.php?document_srl=$1 [L,QSA]

# mid link
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_]+)/?$ ./index.php?mid=$1 [L,QSA]
# mid + document link
RewriteRule ^([a-zA-Z0-9_]+)/([0-9]+)$ ./index.php?mid=$1&document_srl=$2 [L,QSA]

# vid + mid link
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/?$ ./index.php?vid=$1&mid=$2 [L,QSA]
# vid + mid + document link
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/([0-9]+)$ ./index.php?vid=$1&mid=$2&document_srl=$3 [L,QSA]

# mid + entry title
RewriteRule ^([a-zA-Z0-9_]+)/entry/(.+)$ ./index.php?mid=$1&entry=$2 [L,QSA]
# vid + mid + entry title
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/entry/(.+)$ ./index.php?vid=$1&mid=$2&entry=$3 [L,QSA]

#shop / vid / [category|product] / identifier
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule ^([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/([a-zA-Z0-9_\.-]+)$ ./index.php?act=route&vid=$1&type=$2&identifier=$3 [L,QSA]

RewriteRule ^sitemap([0-9]*)\.xml$ ./index.php?module=sitemap&act=sitemap&page=$1 [L]

#### redirect 사이트 #####
		    						      
##  seminar subdomain
RewriteCond $1 !^(redirect/seminar)/
RewriteCond %{HTTP_HOST} seminar.gocoder\.net [NC]
RewriteRule ^(.*)$ /redirect/seminar/$1 [L]

## blog tistory subdomain
RewriteCond $1 !^(redirect/tistory)/
RewriteCond %{HTTP_HOST} blog.gocoder\.net [NC]
RewriteRule ^(.*)$ /redirect/tistory/$1 [L]


#### tools 사이트 #####
		      
##  publicproject subdomain
RewriteCond $1 !^(tools/publicproject)/
RewriteCond %{HTTP_HOST} publicproject.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/publicproject/$1 [L]

## blog race subdomain
RewriteCond $1 !^(tools/race)/
RewriteCond %{HTTP_HOST} race.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/race/$1 [L]

##  packer subdomain
RewriteCond $1 !^(tools/packer)/
RewriteCond %{HTTP_HOST} packer.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/packer/$1 [L]
		     
## tex TO Png  subdomain
RewriteCond $1 !^(tools/text2png)/
RewriteCond %{HTTP_HOST} ^text2png\.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/text2png/$1 [L]

## picsmall  subdomain
RewriteCond $1 !^(tools/picsmall)/
RewriteCond %{HTTP_HOST} picsmall.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/picsmall/$1 [L]

## mcapture  subdomain
RewriteCond $1 !^(tools/mcapture)/
RewriteCond %{HTTP_HOST} mcapture.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/mcapture/$1 [L]

## epub  subdomain
RewriteCond $1 !^(tools/epub)/
RewriteCond %{HTTP_HOST} epub.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/epub/$1 [L]

## monitor  subdomain
RewriteCond $1 !^(tools/monitor)/
RewriteCond %{HTTP_HOST} monitor.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/monitor/$1 [L]

## qrcode subdomain
RewriteCond $1 !^(tools/qrcode)/
RewriteCond %{HTTP_HOST} qrcode.gocoder\.net [NC]
RewriteRule ^(.*)$ /tools/qrcode/$1 [L]

#### 독립 사이트 #####

##  resume subdomain
RewriteCond $1 !^(resume)/
RewriteCond %{HTTP_HOST} resume.gocoder\.net [NC]
RewriteRule ^(.*)$ /resume/$1 [L]

## wedding subdomain
RewriteCond $1 !^(wedding)/
RewriteCond %{HTTP_HOST} wedding.gocoder\.net [NC]
RewriteRule ^(.*)$ /wedding/$1 [L]

## sarang subdomain
 RewriteCond $1 !^(sarang)/
 RewriteCond %{HTTP_HOST} sarang.gocoder\.net [NC]
 RewriteRule ^(.*)$ /sarang/$1 [L]




